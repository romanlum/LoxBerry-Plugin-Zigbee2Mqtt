<style>
    .mono {
        font-family: monospace;
        font-size: 110%;
        font-weight: bold;
        color: green;
    }

    #overlay {
        display: none !important;
    }

    /* Custom indentations are needed because the length of custom labels differs from
   the length of the standard labels */
    .custom-size-flipswitch.ui-flipswitch .ui-btn.ui-flipswitch-on {
        text-indent: -5.9em;
    }

    .custom-size-flipswitch.ui-flipswitch .ui-flipswitch-off {
        text-indent: 0.5em;
    }

    /* Custom widths are needed because the length of custom labels differs from
   the length of the standard labels */
    .custom-size-flipswitch.ui-flipswitch {
        width: 8.875em;
    }

    .custom-size-flipswitch.ui-flipswitch.ui-flipswitch-active {
        padding-left: 7em;
        width: 1.875em;
    }

    .submitting {
        color: grey;
    }

    .saveok {
        color: green;
    }

    .saveerror {
        color: red;
    }

    #service_running {
        color: green;
    }

    #service_not_running {
        color: red;
    }

    @media (min-width: 28em) {

        /*Repeated from rule .ui-flipswitch above*/
        .ui-field-contain>label+.custom-size-flipswitch.ui-flipswitch {
            width: 1.875em;
        }
    }
</style>

<!-- Form SETTINGS -->
<form id="ServiceConfig" onsubmit="return false;">
    <div class="wide">Zigbee2Mqtt</div>
    <p><i>{{ 'ServiceConfig.Desc' | trans }}</i></p>

    <!-- Service -->
    <div class="lb_flex-container">
        <div class="lb_flex-item-label">
            <label class="control-label" for="ServiceConfig[permitJoin]">{{ 'ServiceConfig.LabelPermitJoin' | trans
                }}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input type="checkbox" name="ServiceConfig[permitJoin]" id="ServiceConfig[permitJoin]">
            </fieldset>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{'ServiceConfig.HintPermitJoin' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container">
        <div class="lb_flex-item-label">
            <label class="control-label" for="ServiceConfig[enableUI]">{{ 'ServiceConfig.LabelEnableUI' | trans
                }}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input type="checkbox" name="ServiceConfig[enableUI]" id="ServiceConfig[enableUI]">
            </fieldset>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{'ServiceConfig.HintEnableUI' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container">
        <div class="lb_flex-item-label">
            <label class="control-label" for="ServiceConfig[port]">{{'ServiceConfig.LabelPort' | trans}}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input width="100%" value="" id="ServiceConfig[port]" name="ServiceConfig[port]" type="text"
                class="textfield">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{'ServiceConfig.HintPort' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container">
        <div class="lb_flex-item-label">
            <label class="control-label" for="ServiceConfig[adapter]">{{'ServiceConfig.LabelAdapter' | trans}}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input width="100%" value="" id="ServiceConfig[adapter]" name="ServiceConfig[adapter]" type="text"
                class="textfield">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{'ServiceConfig.HintAdapter' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>
</form>

<form id="MqttConfig" onsubmit="return false;">
    <div class="wide">MQTT</div>
    <p><i>{{ 'Mqtt.Desc' | trans }}</i></p>

    <div class="lb_flex-container">
        <div class="lb_flex-item-label">
            <label class="control-label" for="MqttConfig[topic]">{{ 'Mqtt.LabelTopic' | trans }}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input width="100%" value="" id="MqttConfig[topic]" name="MqttConfig[topic]" type="text" class="textfield"
                data-validation-rule="^(?!.*//.*)[^\+#]+$"
                data-validation-error-msg="{{ 'Mqtt.ValInvalidTopic' | trans }}">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{ 'Mqtt.HintTopic' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    {% if mqtt_installed == true %}
    <div class="lb_flex-container">
        <div class="lb_flex-item-label">
            <label class="control-label" for="MqttConfig[usemqttgateway]">{{'Mqtt.LabelUseMqttGateway' | trans}}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input type="checkbox" name="MqttConfig[usemqttgateway]" id="MqttConfig[usemqttgateway]">
            </fieldset>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{'Mqtt.HintUseMqttGateway' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container">
        <div class="lb_flex-item-label">
            <label class="control-label" for="MqttConfig[registerMqttTopic]">{{'Mqtt.LabelRegisterMqttTopic' |
                trans}}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input type="checkbox" name="MqttConfig[registerMqttTopic]" id="MqttConfig[registerMqttTopic]">
            </fieldset>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{'Mqtt.HintRegisterMqttTopic' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container MQTT">
        <div class="lb_flex-item-label">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <span id="mqtt_onverviewlink"><a href="/admin/system/mqtt-gateway.cgi?form=incoming" target="_blank">{{
                    'Common.MqttGatwayIncomming' | trans }}</a></span>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>
    {% else %}
    <div class="lb_flex-container">
        {{ 'Common.MqttGatewayNotInstalled' | trans }}
    </div>
    {% endif %}

    <div class="lb_flex-container MQTT ownbroker" style="display:none">
        <div class="lb_flex-item-label">
            <label class="control-label" for="MqttConfig[server]">{{ 'Mqtt.LabelServer' | trans }}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input width="100%" value="" id="MqttConfig[server]" name="MqttConfig[server]" type="text" class="textfield"
                data-validation-rule="special:hostname_or_ipaddr"
                data-validation-error-msg="{{ 'Mqtt.ValInvalidServer' | trans }}">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{ 'Mqtt.HintServer' | trans }}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container MQTT ownbroker" style="display:none">
        <div class="lb_flex-item-label">
            <label class="control-label" for="MqttConfig[port]">{{ 'Mqtt.LabelPort' | trans }}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input width="100%" value="" id="MqttConfig[port]" name="MqttConfig[port]" type="text" class="textfield"
                data-validation-rule="special:number-min-max-value:1:65000"
                data-validation-error-msg="{{ 'Mqtt.ValInvalidPort' | trans }}">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{ 'Mqtt.HintPort' | trans }}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container MQTT ownbroker" style="display:none">
        <div class="lb_flex-item-label">
            <label class="control-label" for="MqttConfig[username]">{{ 'Mqtt.LabelUsername' | trans }}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input width="100%" value="" id="MqttConfig[username]" name="MqttConfig[username]" type="text"
                class="textfield">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{ 'Mqtt.HintUsername' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div class="lb_flex-container MQTT ownbroker" style="display:none">
        <div class="lb_flex-item-label">
            <label class="control-label" for="MqttConfig[password]">{{ 'Mqtt.LabelPassword' | trans}}</label>
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item">
            <input width="100%" value="" id="MqttConfig[password]" name="MqttConfig[password]" type="text"
                class="textfield">
        </div>
        <div class="lb_flex-item-spacer"></div>
        <div class="lb_flex-item-help hint">
            {{ 'Mqtt.HintPassword' | trans}}
        </div>
        <div class="lb_flex-item-spacer"></div>
    </div>

    <div style="padding: 0px 0px 20px 0px;"></div>

</form>


<div style="display:flex;align-items:center;justify-content:center;height:16px;min-height:16px">
    <span id="savemessages">
        <div class="submitting" style="display: none;">
            {{ 'Common.Submitting' | trans }}
        </div>
        <div class="saveok" style="display: none;">
            {{ 'Common.HintSaveOK' | trans }}
        </div>
        <div class="saveerror" style="display: none;">
            {{ 'Common.HintSaveError' | trans }}
        </div>

    </span>
</div>
<div style="display:flex;align-items:center;justify-content:center;">
    <button class="ui-btn ui-btn-icon-right" id="saveapply" data-inline="true">{{ 'Common.SaveApply' | trans}}</button>
</div>
<div style="display:flex;align-items:center;justify-content:center;" hidden>
    <span style="display:none" id="service_running">{{'Common.ServiceRunning' | trans}} (PID <div style="display:inline"
            id="servicepid">0
        </div>)</span>
    <span style="display:none" id="service_not_running">{{'Common.ServiceNotRunning' | trans}}</span>
</div>